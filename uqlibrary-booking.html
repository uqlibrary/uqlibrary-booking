<link rel="import" href="../polymer/polymer.html">

<link rel="import" href="../core-animated-pages/core-animated-pages.html">
<link rel="import" href="../core-animated-pages/transitions/slide-from-right.html">
<link rel="import" href="../core-animated-pages/transitions/hero-transition.html">
<link rel="import" href="../core-animated-pages/transitions/cross-fade.html">

<link rel="import" href="../core-drawer-panel/core-drawer-panel.html">
<link rel="import" href="../core-header-panel/core-header-panel.html">
<link rel="import" href="../core-toolbar/core-toolbar.html">
<link rel="import" href="../core-menu/core-menu.html">
<link rel="import" href="../core-icons/core-icons.html">
<link rel="import" href="../core-icons/social-icons.html">
<link rel="import" href="../core-icons/av-icons.html">

<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../paper-item/paper-item.html">
<link rel="import" href="../paper-fab/paper-fab.html">

<link rel="import" href="../uqlibrary-timeline/uqlibrary-timeline.html">
<link rel="import" href="../uqlibrary-fbs-filter-form/uqlibrary-fbs-filter-form.html">

<polymer-element name="uqlibrary-booking">

  <template>
    <link rel="stylesheet" href="uqlibrary-booking.css">

    <core-drawer-panel id="drawerPanel" responsiveWidth="9999px">

      <core-header-panel drawer id="drawer">
        <core-menu>
          <paper-item label="Dashboard"></paper-item>
          <paper-item label="Agenda"></paper-item>
          <paper-item label="Study"></paper-item>
          <paper-item label="Library"></paper-item>
          <paper-item label="News"></paper-item>
          <paper-item label="Events"></paper-item>
          <paper-item label="Settings"></paper-item>
          <paper-item label="Logout"></paper-item>
        </core-menu>
      </core-header-panel>

      <core-header-panel main id="main">
        <core-toolbar>
          <paper-icon-button id="toolBarLeftButton"
                             hidden?="{{!pageToolbar.leftButton.icon}}"
                             icon="{{pageToolbar.leftButton.icon ? pageToolbar.leftButton.icon : ''}}"
                             on-tap="{{doTransition}}"></paper-icon-button>
          <span flex id="toolbar-page-title">{{pageToolbar.title}}</span>
          <paper-icon-button id="toolBarRightButton"
                             on-tap="{{doTransition}}"
                             hidden?="{{!pageToolbar.rightButton.icon}}"
                             icon="{{pageToolbar.rightButton.icon ? pageToolbar.rightButton.icon : ''}}"></paper-icon-button>
        </core-toolbar>

        <div id="content">
          <core-animated-pages id="pages"
                               transitions="{{transition}}">

            <section id="myBookings">
                <div class="wrapper">
                  <uqlibrary-timeline events="{{events}}"></uqlibrary-timeline>
                  <paper-fab hero-id="filterForm"
                             hero?="{{transition === 'hero-transition'}}"
                             id="addBookingButton"
                             icon="add"
                             class="action"
                             on-tap="{{doTransition}}"></paper-fab>
                </div>
            </section>

            <section id="filterForm">
              <uqlibrary-fbs-filter-form hero-id="filterForm"
                                         hero?="{{transition === 'hero-transition'}}"
                                         id="fbs-filter-form"
                                         formData="{{filterFormData}}"></uqlibrary-fbs-filter-form>
            </section>

          </core-animated-pages>
        </div>

      </core-header-panel>

    </core-drawer-panel>

  </template>

  <script>
    (function() {
      Polymer('uqlibrary-booking', {

        transition: 'hero-transition',

        ready: function() {
          this.pageTransitions = {
            addBookingButton: {
              transition: 'hero-transition',
              destination: 'filterForm',
              action: 'showFilterForm'
            }
          };
          this.showMyBookings();
        },

        created: function () {
          this.loadEvents();
          this.loadFilterFormData();
        },

        togglePanel: function () {
          this.$.drawerPanel.togglePanel();
        },

        doTransition: function (e, data, sender) {
          var p = this.pageTransitions[sender.id];
          if (p.transition) {
            this.transition = p.transition;
          }
          if (p.destination) {
            this.$.pages.selectedItem = this.$[p.destination];
          }
          if (p.action) {
            this[p.action]();
          }
        },

        showMyBookings: function() {
          this.pageTransitions.toolBarLeftButton = {
            action: 'togglePanel'
          };
          this.pageToolbar = {
            leftButton: {icon:'menu'},
            title: 'My bookings',
            rightButton: {icon:'drawer'}
          };
        },

        showFilterForm: function() {
          this.pageTransitions.toolBarLeftButton ={
            transition: 'slide-from-right',
            destination: 'myBookings',
            action: 'showMyBookings'
          };
          this.pageToolbar = {
            leftButton: {icon:'arrow-back'},
            title: 'Find a room'
          }
        },

        loadEvents: function () {
          this.events = [
            {
              date: new Date().setHours(0, 0, 0, 0),
              title: "Item title",
              subtitle: "Second line",
              text: "Third line"
            },
            {
              date: new Date().setHours(25, 0, 0, 0),
              title: "Item title",
              subtitle: "Second line",
              text: "Third line"
            },
            {
              date: new Date().setHours(26, 0, 0, 0),
              title: "Item title",
              subtitle: "Second line",
              text: "Third line"
            },
            {
              date: new Date().setHours(72, 0, 0, 0),
              title: "Item title",
              subtitle: "Second line",
              text: "Third line"
            }
          ];
        },

        loadFilterFormData: function() {
          this.filterFormData = [];
          this.filterFormData.dates = [];
          var today = new Date();
          for(var i = 0; i < 7; i++) {
            this.filterFormData.dates.push({
              date: new Date().setDate(today.getDate() + i)
            });
          }


          this.filterFormData.facilities = [
            {
              title: 'St Lucia',
              id: 'stlucia',
              buildings: [
                {
                  title: 'Biological Sciences Library',
                  id: 'bsl',
                  rooms: [
                    {
                      title: 'Biological Sciences Library Group Room 1',
                      id: 'gr1'

                    },
                    {
                      title: 'Group Room 2',
                      id: 'gr2'

                    },
                    {
                      title: 'Individual Room',
                      id: 'ir'

                    }

                  ]

                },
                {
                  title: 'Duhig Building',
                  id: 'dh',
                  rooms: [
                    {
                      title: 'Group Room 1',
                      id: 'gr1'

                    },
                    {
                      title: 'Projector',
                      id: 'projector'

                    },
                    {
                      title: 'Individual Room',
                      id: 'ir'

                    }

                  ]

                },
                {
                  title: 'Duhig Building 1',
                  id: 'dh1',
                  rooms: [
                    {
                      title: 'Group Room 1',
                      id: 'gr1'

                    },
                    {
                      title: 'Projector',
                      id: 'projector'

                    },
                    {
                      title: 'Individual Room',
                      id: 'ir'

                    }

                  ]

                },
                {
                  title: 'Duhig Building',
                  rooms: [
                    {
                      title: 'Group Room 1',
                      id: 'gr1'

                    },
                    {
                      title: 'Projector',
                      id: 'projector'

                    },
                    {
                      title: 'Individual Room',
                      id: 'ir'

                    }

                  ]

                },
                {
                  title: 'Duhig Building 2',
                  id: 'dh2',
                  rooms: [
                    {
                      title: 'Group Room 1',
                      id: 'gr1'
                    },
                    {
                      title: 'Projector',
                      id: 'projector'

                    },
                    {
                      title: 'Individual Room',
                      id: 'ir'

                    }

                  ]

                },
              ]
            },
            {
              title: 'Gatton',
              id: 'gatton',
              buildings: [
                {
                  title: 'Gatton Biological Sciences Library',
                  id: 'bsl',
                  rooms: [
                    {
                      title: 'Group Room 1',
                      id: 'gr1'

                    },
                    {
                      title: 'Group Room 2',
                      id: 'gr2'

                    },
                    {
                      title: 'Individual Room',
                      id: 'ir'

                    }

                  ]

                },
                {
                  title: 'Gatton Duhig Building',
                  id: 'dh',
                  rooms: [
                    {
                      title: 'Group Room 1',
                      id: 'gr1'

                    },
                    {
                      title: 'Projector',
                      id: 'projector'

                    },
                    {
                      title: 'Individual Room',
                      id: 'ir'

                    }

                  ]

                },
                {
                  title: 'Gatton Duhig Building 1',
                  id: 'dh1',
                  rooms: [
                    {
                      title: 'Group Room 1',
                      id: 'gr1'

                    },
                    {
                      title: 'Projector',
                      id: 'projector'

                    },
                    {
                      title: 'Individual Room',
                      id: 'ir'

                    }

                  ]

                },

              ]
            },

          ];

        }

      });
    })();
  </script>

</polymer-element>
